import{F as _,S as se,R as O,a as le,s as oe,c as ie,d as ae,e as ne,f as re,h as de,i as ue,j as q,k as ce,l as W}from"./shareTable-eec3b15e.js";import{d as J,r as E,k as P,b as C,e as pe,f as V,o as r,c as d,g as o,w as u,F as k,i as R,a,h as F,n as B,u as i,t as c,l as he,p as _e,j as fe,m as D,_ as ve}from"./index-72b3c2dd.js";const K=J("fleetFightView",()=>{const n=E(null);return{selectedShip:n,setselectedShip:(p,M)=>{n.value={id:p,factions:M}},calculateIsSelectedShipModel:(p,M)=>{var h;return((h=n.value)==null?void 0:h.id)==p&&n.value.factions==M}}}),$=[{warshipModel:ie,count:3},{warshipModel:ae,count:3},{warshipModel:ne,count:5},{warshipModel:re,count:5},{warshipModel:de,count:2}],we=J("fleetNew",()=>{const n=K(),l=E({id:P(),shipList:[]}),s=E({id:P(),shipList:[]});l.value.shipList.splice(0,0,...$),s.value.shipList.splice(0,0,...$);const p=C(()=>{const f=[];return l.value.shipList.forEach(y=>{y.warshipModel.weaponList.forEach(I=>{f.push(Se(I,s.value))})}),f}),M=C(()=>{var f;if(n.selectedShip&&n.selectedShip.factions==_.Our)return Me((f=n.selectedShip)==null?void 0:f.id,l.value,p.value)});return{ourFleet:l,enemyFleet:s,ourFleetSharePoolList:p,ourSelectedShipSharePool:M,addShipToFleet:(f,y,I)=>{const L=I==_.Our?l:s;for(let w=0;w<L.value.shipList.length;w++)if(L.value.shipList[w].warshipModel.id==f.id){L.value.shipList[w].count+=y;return}L.value.shipList.push({warshipModel:f,count:y})},deleteShipFromFleet:(f,y,I,L)=>{const w=I==_.Our?l:s;for(let g=0;g<w.value.shipList.length;g++)w.value.shipList[g].warshipModel.id==f.id&&(w.value.shipList[g].count-y<=0||L?w.value.shipList.splice(g,1):w.value.shipList[g].count-=y)}}});function Se(n,l){let s=l.shipList;n.shootMode==se.DirectFire&&(s=l.shipList.filter(h=>h.warshipModel.shipTemplate.standRow==O.Front));let p=le.Frigate;s.forEach(h=>{const b=z(n,p);z(n,h.warshipModel.shipTemplate.shipType)<b&&(p=h.warshipModel.shipTemplate.shipType)}),s=s.filter(h=>h.warshipModel.shipTemplate.shipType==p);const M=oe.get(s.length);return{id:P(),weaponModelId:n.id,shareNumber:M||0,shipList:s}}function z(n,l){return n.attackSequence.findIndex(s=>s==l)}function Me(n,l,s){var M;const p=(M=l.shipList.find(h=>h.warshipModel.id==n))==null?void 0:M.warshipModel.weaponList;if(p){const h=[];return p.forEach(b=>{console.log(b.id);const f=s.find(y=>y.weaponModelId==b.id);f&&h.push(f)}),h}}const S=n=>(_e("data-v-a700ff36"),n=n(),fe(),n),me=S(()=>a("h1",null,"无尽的拉格朗日舰队分析助手",-1)),ye=S(()=>a("div",null,"备注：目前的锁定序列和分摊计算不一定正确，UI样式也不是最终稿，仅为开发中原型核心计算功能演示，请大家多多提出意见",-1)),ke={class:"fleet-root"},Fe=S(()=>a("div",{class:"fleet-row"},"后排",-1)),Le=["onClick"],ge=S(()=>a("div",{class:"fleet-row"},"中排",-1)),Te=["onClick"],Ce=S(()=>a("div",{class:"fleet-row"},"前排",-1)),be=["onClick"],Ie={class:"fleet-root"},xe=S(()=>a("div",{class:"fleet-row"},"前排",-1)),Ne=["onClick"],Oe=S(()=>a("div",{class:"fleet-row"},"中排",-1)),Ee=["onClick"],Re=S(()=>a("div",{class:"fleet-row"},"后排",-1)),Be=["onClick"],Ve=S(()=>a("br",null,null,-1)),Ae={class:"fleet-root"},We=S(()=>a("div",{class:"fleet-row"},"舰队武器分摊池",-1)),Ue=S(()=>a("br",null,null,-1)),He={class:"share-number"},Pe=S(()=>a("div",{class:"be-attacked-ship"},"可以攻击的敌方舰船：",-1)),je={key:0,class:"fleet-root"},qe={class:"fleet-row"},De=S(()=>a("div",{class:"fleet-row"},"选中的舰船的武器分摊池",-1)),$e=S(()=>a("br",null,null,-1)),ze={class:"share-number"},Je=S(()=>a("div",{class:"be-attacked-ship"},"可以攻击的敌方舰船：",-1)),Ke=pe({__name:"index",setup(n){const l=we(),s=K(),p=(t,v)=>s.calculateIsSelectedShipModel(t,v)?"fleet-row--selected":"fleet-row",M=C(()=>l.ourFleet.shipList.filter(t=>t.warshipModel.shipTemplate.standRow==O.Front)),h=C(()=>l.ourFleet.shipList.filter(t=>t.warshipModel.shipTemplate.standRow==O.Middle)),b=C(()=>l.ourFleet.shipList.filter(t=>t.warshipModel.shipTemplate.standRow==O.Back)),f=C(()=>l.enemyFleet.shipList.filter(t=>t.warshipModel.shipTemplate.standRow==O.Front)),y=C(()=>l.enemyFleet.shipList.filter(t=>t.warshipModel.shipTemplate.standRow==O.Middle)),I=C(()=>l.enemyFleet.shipList.filter(t=>t.warshipModel.shipTemplate.standRow==O.Back)),L=ue.map(t=>({value:t.id,label:t.name})),w=E(1),g=E([...L]),x=E(void 0),Q=t=>{x.value=t},X=()=>{if(!x.value)return;const t=W(x.value);console.log(`为己方舰队添加 ${t==null?void 0:t.name}`),t&&l.addShipToFleet(t,w.value,_.Our)},Y=()=>{if(!x.value)return;const t=W(x.value);console.log(`为敌方舰队添加 ${t==null?void 0:t.name}`),t&&l.addShipToFleet(t,w.value,_.Enemy)},Z=(t,v)=>v.label.indexOf(t.toLowerCase())>=0,U=E(1),G=()=>{var v;if(!((v=s.selectedShip)!=null&&v.id)){D.error("请先选中一条舰船再执行删除指令");return}const t=W(s.selectedShip.id);l.deleteShipFromFleet(t,U.value,s.selectedShip.factions)},ee=()=>{var v;if(!((v=s.selectedShip)!=null&&v.id)){D.error("请先选中一条舰船再执行删除指令");return}const t=W(s.selectedShip.id);l.deleteShipFromFleet(t,0,s.selectedShip.factions,!0)};return(t,v)=>{const N=V("a-row"),te=V("a-select"),j=V("a-input-number"),A=V("a-button"),m=V("a-col");return r(),d(k,null,[o(N,{gutter:8},{default:u(()=>[me,ye]),_:1}),o(N,{gutter:8},{default:u(()=>[o(te,{value:x.value,"onUpdate:value":v[0]||(v[0]=e=>x.value=e),"show-search":"",placeholder:"选择一条舰船来添加",style:{width:"200px"},options:g.value,onChange:Q,"filter-option":Z},null,8,["value","options"]),o(j,{value:w.value,"onUpdate:value":v[1]||(v[1]=e=>w.value=e),min:1,max:1e5},null,8,["value"]),o(A,{onClick:X,type:"primary"},{default:u(()=>[R("向己方舰队添加舰船")]),_:1}),o(A,{onClick:Y,type:"primary"},{default:u(()=>[R("向敌方舰队添加舰船")]),_:1})]),_:1}),o(N,{gutter:8},{default:u(()=>[o(j,{value:U.value,"onUpdate:value":v[2]||(v[2]=e=>U.value=e),min:1,max:1e5},null,8,["value"]),o(A,{onClick:G,type:"primary",danger:""},{default:u(()=>[R("删除给定的数量")]),_:1}),o(A,{onClick:ee,type:"primary",danger:""},{default:u(()=>[R("删除全部此型号舰船")]),_:1})]),_:1}),o(N,{gutter:8},{default:u(()=>[o(m,{span:12},{default:u(()=>[a("div",ke,[o(N,{gutter:8},{default:u(()=>[o(m,{span:8},{default:u(()=>[Fe,(r(!0),d(k,null,F(b.value,e=>(r(),d("div",{class:B(p(e.warshipModel.id,i(_).Our)),key:e.warshipModel.name,onClick:()=>{i(s).setselectedShip(e.warshipModel.id,i(_).Our)}},c(e.warshipModel.name)+" * "+c(e.count),11,Le))),128))]),_:1}),o(m,{span:8},{default:u(()=>[ge,(r(!0),d(k,null,F(h.value,e=>(r(),d("div",{class:B(p(e.warshipModel.id,i(_).Our)),key:e.warshipModel.name,onClick:()=>{i(s).setselectedShip(e.warshipModel.id,i(_).Our)}},c(e.warshipModel.name)+" * "+c(e.count),11,Te))),128))]),_:1}),o(m,{span:8},{default:u(()=>[Ce,(r(!0),d(k,null,F(M.value,e=>(r(),d("div",{class:B(p(e.warshipModel.id,i(_).Our)),key:e.warshipModel.name,onClick:()=>{i(s).setselectedShip(e.warshipModel.id,i(_).Our)}},c(e.warshipModel.name)+" * "+c(e.count),11,be))),128))]),_:1})]),_:1})])]),_:1}),o(m,{span:12},{default:u(()=>[a("div",Ie,[o(N,{gutter:8},{default:u(()=>[o(m,{span:8},{default:u(()=>[xe,(r(!0),d(k,null,F(f.value,e=>(r(),d("div",{class:B(p(e.warshipModel.id,i(_).Enemy)),key:e.warshipModel.name,onClick:()=>{i(s).setselectedShip(e.warshipModel.id,i(_).Enemy)}},c(e.warshipModel.name)+" * "+c(e.count),11,Ne))),128))]),_:1}),o(m,{span:8},{default:u(()=>[Oe,(r(!0),d(k,null,F(y.value,e=>(r(),d("div",{class:B(p(e.warshipModel.id,i(_).Enemy)),key:e.warshipModel.name,onClick:()=>{i(s).setselectedShip(e.warshipModel.id,i(_).Enemy)}},c(e.warshipModel.name)+" * "+c(e.count),11,Ee))),128))]),_:1}),o(m,{span:8},{default:u(()=>[Re,(r(!0),d(k,null,F(I.value,e=>(r(),d("div",{class:B(p(e.warshipModel.id,i(_).Enemy)),key:e.warshipModel.name,onClick:()=>{i(s).setselectedShip(e.warshipModel.id,i(_).Enemy)}},c(e.warshipModel.name)+" * "+c(e.count),11,Be))),128))]),_:1})]),_:1})])]),_:1})]),_:1}),Ve,o(N,{gutter:8},{default:u(()=>[o(m,{span:6},{default:u(()=>[a("div",Ae,[We,(r(!0),d(k,null,F(i(l).ourFleetSharePoolList,e=>(r(),d("div",{class:"fleet-row",key:e.id},[a("div",null,[R(" 武器名称： "+c(i(q)(e.weaponModelId))+" ",1),Ue,a("div",He,"分摊数： "+c(e.shareNumber),1)]),Pe,(r(!0),d(k,null,F(e.shipList,T=>(r(),d("div",{class:"be-attacked-ship",key:T.warshipModel.name},c(T.warshipModel.name)+" * "+c(T.count),1))),128))]))),128))])]),_:1}),o(m,{span:6},{default:u(()=>{var e;return[i(l).ourSelectedShipSharePool?(r(),d("div",je,[a("div",qe,"当前选中的舰船："+c(i(ce)((e=i(s).selectedShip)==null?void 0:e.id)),1),De,(r(!0),d(k,null,F(i(l).ourSelectedShipSharePool,T=>(r(),d("div",{class:"fleet-row",key:T.id},[a("div",null,[R(" 武器名称： "+c(i(q)(T.weaponModelId))+" ",1),$e,a("div",ze,"分摊数： "+c(T.shareNumber),1)]),Je,(r(!0),d(k,null,F(T.shipList,H=>(r(),d("div",{class:"be-attacked-ship",key:H.warshipModel.name},c(H.warshipModel.name)+" * "+c(H.count),1))),128))]))),128))])):he("",!0)]}),_:1}),o(m,{span:6}),o(m,{span:6})]),_:1})],64)}}});const Ye=ve(Ke,[["__scopeId","data-v-a700ff36"]]);export{Ye as default};
